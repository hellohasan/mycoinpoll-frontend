import{r as P,D as ae,c as o,o as a,a as t,x as U,u as e,t as w,e as z,R as de,j as be,s as Y,Z as ue,g as q,f as A,v as W,aH as ye,aI as _e,aJ as te,aK as se,aL as R,F as B,b as u,J as we,_ as xe,h as Se,n as ee,d as V,aM as J,p as ie,m as K,P as ke,Q as Ce,aN as ce}from"./6IpCoGFE.js";import{S as g}from"./BeJkmax2.js";import{a as Ee}from"./CaNsbxwq.js";import{u as pe,a as me}from"./DPzlc_os.js";import{u as $e}from"./BZvXcbvV.js";import{_ as De}from"./x9cXak0-.js";import{u as Te}from"./GevnLgCi.js";const Me={class:"ecm-left-side"},Ae={class:"ecm-address mt40"},Pe={key:1},Fe={class:"d-flex align-items-center mt40 g30 flex-wrap"},Ue={__name:"IcoInfo",setup(C){const r=P(""),i=ae(),{data:b,pending:k}=Ee(`${i.public.apiBase}/get-ecm-info`,{onResponse:({response:c})=>{r.value=c._data.contract_address}},"$NxkBcRfFAk"),x=c=>{let d;d="/pdf/ECM-Whitepaper.pdf";const h=document.createElement("a");h.href=d,h.download=d.split("/").pop(),document.body.appendChild(h),h.click(),document.body.removeChild(h)};return(c,d)=>(a(),o("div",Me,[d[3]||(d[3]=t("div",{class:"section-heading"},[t("h3",{class:"text-shadow"},"Unlocking eCommerce Potential with Digital Coin Solutions"),t("p",null,"Explore the ECM Cloud for Seamless eCommerce Integration, Unlocking Innovative Tools to Elevate your Metaverse Experience.")],-1)),t("div",Ae,[d[1]||(d[1]=t("h5",null,"ECM Contact Address",-1)),e(k)?(a(),U(e(g),{key:0,class:"bordered",height:"30px",pill:""})):(a(),o("p",Pe,w(e(r)),1))]),t("ul",Fe,[t("li",null,[t("a",{role:"button",onClick:d[0]||(d[0]=z(h=>x(),["prevent"])),class:"btn1 primary-btn"},"White Paper")]),d[2]||(d[2]=t("li",null,[t("a",{href:"https://ecmcoin.com",target:"_blank",class:"btn2 primary-btn"},"Official Website")],-1))])]))}},fe=de("referral",{state:()=>({referral:"0x0000000000000000000000000000000000000000"}),actions:{updateReferral(C){this.referral=C}}}),Ie={key:0,class:"d-flex flex-column g-10 mt-20"},Re={class:"address-text input-group d-flex align-items-center secondary-btn-sm"},Be=["value"],Ne={key:0,class:"address-text input-group d-flex align-items-center position-relative secondary-btn-sm"},Le=["value"],He={class:"address-text input-group d-flex align-items-center secondary-btn-sm"},Ve={__name:"Referral",setup(C){const r=pe(),i=fe(),b=be(),{authenticated:k,user:x}=Y(b),c=P(""),d=ae(),{copyNow:h}=$e(),p=async()=>{await h(c.value)};ue(k,E=>{E?c.value=`${d.public.appUrl}?ref=${x.value.unique_id}`:c.value=""},{immediate:!0});const y=E=>{const l=E.target.value;!l||!ye(l)||l==r.value.address?i.updateReferral("0x0000000000000000000000000000000000000000"):i.updateReferral(l)};return(E,l)=>e(r).isConnected?(a(),o("div",Ie,[t("div",Re,[l[1]||(l[1]=t("span",{class:"gradient-color",id:"wallet_address"},"Your Address:",-1)),t("input",{type:"text",class:"form-control",value:e(r).address,readonly:"",id:"wallet_address",placeholder:"Your Address"},null,8,Be)]),e(c)?(a(),o("div",Ne,[l[3]||(l[3]=t("span",{class:"gradient-color",id:"referral_link"},"Referral Link:",-1)),t("input",{type:"text",class:"form-control",value:e(c),readonly:"",id:"referral_link",placeholder:"Referral Link"},null,8,Le),t("button",{class:"text-copy-btn",type:"button",onClick:z(p,["prevent"]),id:"referred_by"},l[2]||(l[2]=[t("i",{class:"far fa-copy"},null,-1)]))])):q("",!0),t("div",He,[l[4]||(l[4]=t("span",{class:"gradient-color",id:"referred_by"},"Referred By:",-1)),A(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[0]||(l[0]=j=>e(i).referral=j),onBlur:y,id:"referred_by",placeholder:"Enter Referred By Wallet"},null,544),[[W,e(i).referral]])]),l[5]||(l[5]=t("div",{class:"line-divider2 w-100 mb20 mt10"},null,-1))])):q("",!0)}},We=3*60*1e3,ge=de("stageData",{state:()=>({currentStage:{index:null,price:"",usdtPrice:"",target:null,tokensSold:null,percentageSold:null},isStageLoading:!1,lastUpdated:null}),getters:{isDataStale(){return this.lastUpdated?new Date().getTime()-this.lastUpdated>We:!0}},actions:{async fetchStageData(C=!1){if(!(!C&&!this.isDataStale))try{this.isStageLoading=!0;const{alchemyLink:r,SaleAddress:i,SaleContractABI:b}=me();if(!r)throw new Error("Alchemy link is not configured");const k=new _e(r);if(!i||!b)throw new Error("Contract address or ABI is missing");const c=await new te(i,b,k).currentStageInfo(),d=Number(se(c[0],0))+1,h=R(c[1]),p=R(c[2]),y=se(c[3],6),E=Number(R(c[6])).toFixed(4),l=parseFloat(h)>0?parseFloat(E)/parseFloat(h)*100:0;this.currentStage={index:d,price:p,usdtPrice:y,target:h,tokensSold:E,percentageSold:l.toFixed(1)},this.lastUpdated=new Date().getTime()}catch(r){throw r}finally{this.isStageLoading=!1}},async forceLoadStageData(){await this.fetchStageData(!0)}},persist:!0}),ze={class:"ecm-right-header"},je={class:"d-flex align-items-center justify-content-between flex-wrap"},Oe={class:"ico-progress"},Je={key:1,class:"progress"},Ke=["aria-valuenow"],Ye={__name:"IcoStat",setup(C){const r=ge(),{currentStage:i,isStageLoading:b}=Y(r);return(k,x)=>{const c=Ve;return a(),o("div",ze,[t("ul",je,[e(b)?(a(),o(B,{key:0},[t("li",null,[u(e(g),{width:"215",height:"30",pill:""})]),t("li",null,[u(e(g),{width:"180",height:"30",pill:""})])],64)):(a(),o(B,{key:1},[t("li",null,"Stage "+w(e(i).index)+": "+w(e(i).tokensSold)+" ECM",1),t("li",null,"Max: "+w(e(i).target)+" ECM",1)],64))]),t("div",Oe,[e(b)?(a(),U(e(g),{key:0,height:"30",pill:""})):(a(),o("div",Je,[t("div",{class:"progress-bar align-items-end",role:"progressbar",style:we({width:e(i).percentageSold+"%"}),"aria-valuenow":e(i).percentageSold,"aria-valuemin":"0","aria-valuemax":"100"},[t("span",null,w(e(i).percentageSold)+"%",1)],12,Ke)]))]),x[0]||(x[0]=t("div",{class:"line-divider2 w-100 mt-20 mb20"},null,-1)),e(b)?(a(),o(B,{key:0},[u(e(g),{width:"100%",height:"52"}),u(e(g),{width:"100%",height:"52",class:"mt-2"})],64)):(a(),U(c,{key:1}))])}}},qe={name:"IxDisconnected"},Qe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 512 512"};function Ze(C,r,i,b,k,x){return a(),o("svg",Qe,r[0]||(r[0]=[t("path",{fill:"currentColor",fillRule:"evenodd",d:"m109.72 221.26l37.711 37.712l25.065-25.064l30.17 30.17l-25.065 25.064l45.255 45.255l25.065-25.064l30.17 30.17l-25.065 25.064l37.713 37.712l-30.17 30.17l-15.085-15.085c-36.49 36.49-92.839 41.015-134.255 13.577l-36.25 36.247l-30.169-30.17l36.248-36.249c-27.438-41.416-22.913-97.765 13.577-134.255L79.55 251.43zM89.75 59.58l362.668 362.668l-30.17 30.17L59.58 89.75zm35.055 237.104c-24.994 24.994-24.994 65.516 0 90.51c24.1 24.1 62.641 24.962 87.773 2.582l2.736-2.582zM437.019 44.81l30.17 30.17l-46.915 46.916c27.438 41.416 22.913 97.765-13.577 134.255l15.085 15.085l-30.17 30.17l-181.02-181.02l30.17-30.17l15.086 15.085c36.49-36.49 92.839-41.015 134.254-13.576zm-148.266 88.079l-2.735 2.582l89.377 89.377c17.735-26.918 22.652-67.857 1.132-89.377c-24.1-24.1-62.641-24.961-87.774-2.582"},null,-1)]))}const Ge=xe(qe,[["render",Ze]]),Xe={class:"row align-items-center"},et={class:"col-xl-6"},tt={class:"col-xl-6"},st={class:"ecm-right-box"},at={class:"ecm-form mt15"},nt={key:0,class:"mb20"},ot={key:1,class:"mb20"},lt={class:"ico-tab mb20"},rt={key:0,class:"d-flex align-items-center g-20"},it={key:1,class:"d-flex align-items-center g-20"},ct={class:"ico-tab-content"},dt={key:1,class:"d-flex justify-content-center mt-1 mb20"},ut={class:"text-white"},pt={class:"subscribe-form"},mt={class:"subscribe-email mb20 d-flex align-items-center mw-100"},ft=["readonly"],gt={class:"subscribe-email mb20 d-flex align-items-center mw-100"},ht=["readonly"],vt=["disabled"],bt={class:"fa fa-spinner fa-spin me-1"},yt={class:"ico-tab-content"},_t={key:1,class:"d-flex justify-content-center mt-1 mb20"},wt={class:"text-white"},xt={class:"subscribe-form"},St={class:"subscribe-email mb20 d-flex align-items-center mw-100"},kt=["readonly"],Ct={class:"subscribe-email mb20 d-flex align-items-center mw-100"},Et=["readonly"],$t=["disabled"],Dt={class:"fa fa-spinner fa-spin me-1"},Tt=["href"],Mt={class:"clip-text"},At=["disabled"],Ht={__name:"Index",setup(C){const r=pe(),i=ae(),{modal:b,disconnect:k,SaleAddress:x,SaleContractABI:c,USDTAddress:d,IERC20ABI:h}=me(),p=P(!1),y=P("Buy ECM"),{toastSuccess:E,toastError:l}=Te(),j=ge(),{currentStage:S,isStageLoading:$}=Y(j),he=fe(),{referral:ne}=Y(he);Se(async()=>{await oe()});const oe=async(f=!1)=>{try{await j.fetchStageData(f)}catch{l("Failed to load stage data. Please try again.")}},_=P(""),D=P(""),T=P(""),N=P("");ue([_,D,T],([f,s,v],[H,M,I])=>{if(s!==M&&!isNaN(s)){const n=parseFloat((s/S.value.price).toFixed(6));_.value=n.toString(),T.value=parseFloat((n*S.value.usdtPrice).toFixed(2)).toString()}else if(v!==I&&!isNaN(v)){const n=parseFloat((v/S.value.usdtPrice).toFixed(6));_.value=n.toString(),D.value=parseFloat((n*S.value.price).toFixed(6)).toString()}else f!==H&&!isNaN(f)&&(D.value=parseFloat((f*S.value.price).toFixed(6)).toString(),T.value=parseFloat((f*S.value.usdtPrice).toFixed(2)).toString())});const L=P("eth-coin-form"),le=f=>{L.value=f},Q=(f,s="eth")=>{const v=Number(f);return isNaN(v)||v<=0?!1:s==="ecm"?v<=S.value.target:!0},re=async f=>{if(!p.value)try{N.value=null,p.value=!0,y.value="Wallet connecting...";const s=parseFloat(S.value.target)-parseFloat(S.value.tokensSold),v=parseFloat(_.value);if(!Q(D.value)||!Q(_.value,"ecm")||!Q(T.value,"usdt"))throw new Error("Enter valid ECM or ETH amount.");if(v>s)throw new Error(`Purchase amount (${v.toFixed(2)} ECM) exceeds maximum purchasable amount (${s.toFixed(2)} ECM)`);const{walletProvider:H}=ke("eip155"),I=await new Ce(H).getSigner();let n;if(f==="USDT"){const O=new te(d,h,I);y.value="Approving USDT...";const m=await O.balanceOf(r.value.address);if(n=ce(T.value,6),BigInt(m)<BigInt(n))throw new Error(`Insufficient USDT balance. You have ${se(m,6)} USDT`);await(await O.approve(x,n)).wait()}const Z=new te(x,c,I);y.value="Transaction Processing...";let G;f==="ETH"?G=await Z.buyECMWithETH(ne.value,{value:ce(D.value,18)}):f==="USDT"&&(G=await Z.buyECMWithUSDT(n,ne.value));const X=await G.wait();N.value=X.hash,await ve();let F={hash:X.hash,buyer:"",amount:"",stage:"",referralAddress:null,referralAmount:null,referralETH:null,paymentType:null};X.logs.forEach(O=>{try{const m=Z.interface.parseLog(O);(m==null?void 0:m.name)==="ECMPurchased"?(F.buyer=m.args[0],F.amount=R(m.args[1]),F.stage=m.args[2].toString(),F.paymentType=m.args[3].toString()):(m==null?void 0:m.name)==="ReferralRewardPaid"&&(F.referralAddress=m.args[0],F.referralAmount=R(m.args[1]),F.referralETH=R(m.args[2]))}catch{}}),await $fetch(`${i.public.apiBase}/purchase-ecm-completed`,{method:"POST",body:JSON.stringify(F)}),E("ECM purchase successfully completed.")}catch(s){const v=s.shortMessage?s.shortMessage.charAt(0).toUpperCase()+s.shortMessage.slice(1):s.message||"Unknown error occurred";l(v)}finally{p.value=!1,y.value="Buy ECM",_.value="",D.value="",T.value=""}},ve=async()=>{await oe(!0)};return(f,s)=>{const v=Ue,H=Ye,M=De,I=Ge;return a(),o("div",Xe,[t("div",et,[u(v)]),t("div",tt,[t("div",st,[u(H),t("div",at,[e($)?(a(),o("h4",nt,[u(e(g),{height:"36",pill:"",class:"mt-2"})])):(a(),o("h4",ot,"ICO is Live")),t("div",lt,[e($)?(a(),o("div",rt,[u(e(g),{width:"50%",as:"div",height:"54",pill:""}),u(e(g),{width:"50%",as:"div",height:"54",pill:""})])):(a(),o("ul",it,[t("li",{class:ee(["ico-tab-btn gradient-btn w-50",{active:e(L)==="eth-coin-form"}]),onClick:s[0]||(s[0]=n=>le("eth-coin-form"))},[u(M,{src:"/images/icon/eth.png",loading:"lazy",alt:"eth"}),s[11]||(s[11]=V(" Buy with ETH ")),s[12]||(s[12]=t("span",{class:"ico-tab-select-icon"},[t("i",{class:"fa-solid fa-circle-check"})],-1))],2),t("li",{class:ee(["ico-tab-btn gradient-btn w-50",{active:e(L)==="usdt-coin-form"}]),onClick:s[1]||(s[1]=n=>le("usdt-coin-form"))},[u(M,{src:"/images/icon/usdt.png",alt:"ecm"}),s[13]||(s[13]=V(" Buy with USDT ")),s[14]||(s[14]=t("span",{class:"ico-tab-select-icon"},[t("i",{class:"fa-solid fa-circle-check"})],-1))],2)]))]),A(t("div",ct,[e($)?(a(),U(e(g),{key:0,height:"30",pill:"",class:"mb-4"})):(a(),o("ul",dt,[t("li",ut,"1 ECM = "+w(e(S).price)+" ETH",1)])),t("div",pt,[e($)?(a(),o(B,{key:0},ie(3,n=>u(e(g),{key:n,class:"mt-2",height:"55"})),64)):(a(),o("form",{key:1,onSubmit:s[5]||(s[5]=z(n=>re("ETH"),["prevent"]))},[t("div",mt,[u(M,{src:"/images/icon/ecm.png",alt:"icon"}),A(t("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>K(_)?_.value=n:null),type:"text",placeholder:"ECM Amount",readonly:e(p)},null,8,ft),[[W,e(_)]])]),t("div",gt,[u(M,{src:"/images/icon/eth.png",alt:"icon"}),A(t("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>K(D)?D.value=n:null),type:"text",placeholder:"ETH Payable",readonly:e(p)},null,8,ht),[[W,e(D)]])]),e(r).isConnected?(a(),o("button",{key:0,type:"submit",disabled:e(p),class:"btn1 primary-btn submit-btn w-100 mb20"},[A(t("i",bt,null,512),[[J,e(p)]]),V(" "+w(e(y)),1)],8,vt)):(a(),o("button",{key:1,type:"button",onClick:s[4]||(s[4]=n=>e(b).open()),class:"btn1 primary-btn submit-btn w-100 mb20"},w(e(y)),1))],32))])],512),[[J,e(L)==="eth-coin-form"]]),A(t("div",yt,[e($)?(a(),U(e(g),{key:0,height:"30",pill:"",class:"mb-4"})):(a(),o("ul",_t,[t("li",wt,"1 ECM = "+w(e(S).usdtPrice)+" USDT",1)])),t("div",xt,[e($)?(a(),o(B,{key:0},ie(3,n=>u(e(g),{key:n,class:"mt-2",height:"55"})),64)):(a(),o("form",{key:1,onSubmit:s[9]||(s[9]=z(n=>re("USDT"),["prevent"]))},[t("div",St,[u(M,{src:"/images/icon/ecm.png",alt:"icon"}),A(t("input",{"onUpdate:modelValue":s[6]||(s[6]=n=>K(_)?_.value=n:null),type:"text",placeholder:"ECM Amount",readonly:e(p)},null,8,kt),[[W,e(_)]])]),t("div",Ct,[u(M,{src:"/images/icon/usdt.png",alt:"icon"}),A(t("input",{"onUpdate:modelValue":s[7]||(s[7]=n=>K(T)?T.value=n:null),type:"text",placeholder:"USDT Payable",readonly:e(p)},null,8,Et),[[W,e(T)]])]),e(r).isConnected?(a(),o("button",{key:0,type:"submit",disabled:e(p),class:"btn1 primary-btn submit-btn w-100 mb20"},[A(t("i",Dt,null,512),[[J,e(p)]]),V(" "+w(e(y)),1)],8,$t)):(a(),o("button",{key:1,type:"button",onClick:s[8]||(s[8]=n=>e(b).open()),class:"btn1 primary-btn submit-btn w-100 mb20"},w(e(y)),1))],32))])],512),[[J,e(L)==="usdt-coin-form"]])]),e($)?(a(),U(e(g),{key:0,height:"55"})):(a(),o(B,{key:1},[e(N)?(a(),o("a",{key:0,href:`https://etherscan.io/tx/${e(N)}`,target:"_blank",class:"green-outline-btn d-flex align-items-center justify-content-between mt-20"},[s[15]||(s[15]=t("span",{class:"gradient-color"},[t("b",null,"Hash:")],-1)),t("span",Mt,w(e(N)),1),s[16]||(s[16]=t("span",{class:"text-copy-btn rotate-50"},[t("i",{class:"fa-solid fa-arrow-right-long"})],-1))],8,Tt)):q("",!0)],64)),t("div",{class:ee(["mt-3",{"text-center":!e($)}])},[e($)?(a(),U(e(g),{key:0,height:"55"})):e(r).isConnected?(a(),o("button",{key:1,type:"button",class:"red-outline-btn w-100 d-flex justify-content-center align-items-center mt-20",disabled:e(p),onClick:s[10]||(s[10]=z((...n)=>e(k)&&e(k)(...n),["prevent"]))},[s[17]||(s[17]=V(" Disconnect ")),u(I)],8,At)):q("",!0)],2)])])])}}};export{Ht as _};
