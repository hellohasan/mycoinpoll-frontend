import{r as P,U as ae,c as o,o as a,a as t,p as U,u as e,t as w,e as z,S as de,Q as be,R as K,c0 as ue,g as q,f as M,v as W,cD as ye,cE as _e,cw as te,cz as se,cx as I,F as B,b as u,I as we,_ as xe,h as Se,n as ee,d as V,bZ as Y,l as ie,A as J,W as ke,X as Ce,cy as ce}from"./--rz71Vb.js";import{S as g}from"./Dcn0Ko4L.js";import{a as Ee}from"./CFwKkAp4.js";import{u as pe,a as me}from"./DNC11X57.js";import{u as $e}from"./C19ZpRXz.js";import{_ as De}from"./PLJPPlAC.js";import{u as Te}from"./-HW9Rane.js";const Ae={class:"ecm-left-side"},Me={class:"ecm-address mt40"},Pe={key:1},Fe={class:"d-flex align-items-center mt40 g30 flex-wrap"},Ue={__name:"IcoInfo",setup(k){const r=P(""),c=ae(),{data:b,pending:C}=Ee(`${c.public.apiBase}/get-ecm-info`,{onResponse:({response:i})=>{r.value=i._data.contract_address}},"$NxkBcRfFAk"),S=i=>{let d;d="/pdf/ECM-Whitepaper.pdf";const h=document.createElement("a");h.href=d,h.download=d.split("/").pop(),document.body.appendChild(h),h.click(),document.body.removeChild(h)};return(i,d)=>(a(),o("div",Ae,[d[3]||(d[3]=t("div",{class:"section-heading"},[t("h3",{class:"text-shadow"},"Unlocking eCommerce Potential with Digital Coin Solutions"),t("p",null,"Explore the ECM Cloud for Seamless eCommerce Integration, Unlocking Innovative Tools to Elevate your Metaverse Experience.")],-1)),t("div",Me,[d[1]||(d[1]=t("h5",null,"ECM Contact Address",-1)),e(C)?(a(),U(e(g),{key:0,class:"bordered",height:"30px",pill:""})):(a(),o("p",Pe,w(e(r)),1))]),t("ul",Fe,[t("li",null,[t("a",{role:"button",onClick:d[0]||(d[0]=z(h=>S(),["prevent"])),class:"btn1 primary-btn"},"White Paper")]),d[2]||(d[2]=t("li",null,[t("a",{href:"https://ecmcoin.com",target:"_blank",class:"btn2 primary-btn"},"Official Website")],-1))])]))}},fe=de("referral",{state:()=>({referral:"0x0000000000000000000000000000000000000000"}),actions:{updateReferral(k){this.referral=k}}}),Re={key:0,class:"d-flex flex-column g-10 mt-20"},Ie={class:"address-text input-group d-flex align-items-center secondary-btn-sm"},Be=["value"],Ne={key:0,class:"address-text input-group d-flex align-items-center position-relative secondary-btn-sm"},Le=["value"],He={class:"address-text input-group d-flex align-items-center secondary-btn-sm"},Ve={__name:"Referral",setup(k){const r=pe(),c=fe(),b=be(),{authenticated:C,user:S}=K(b),i=P(""),d=ae(),{copyNow:h}=$e(),p=async()=>{await h(i.value)};ue(C,E=>{E?i.value=`${d.public.appUrl}?ref=${S.value.unique_id}`:i.value=""},{immediate:!0});const y=E=>{const l=E.target.value;!l||!ye(l)||l==r.value.address?c.updateReferral("0x0000000000000000000000000000000000000000"):c.updateReferral(l)};return(E,l)=>e(r).isConnected?(a(),o("div",Re,[t("div",Ie,[l[1]||(l[1]=t("span",{class:"gradient-color",id:"wallet_address"},"Your Address:",-1)),t("input",{type:"text",class:"form-control",value:e(r).address,readonly:"",id:"wallet_address",placeholder:"Your Address"},null,8,Be)]),e(i)?(a(),o("div",Ne,[l[3]||(l[3]=t("span",{class:"gradient-color",id:"referral_link"},"Referral Link:",-1)),t("input",{type:"text",class:"form-control",value:e(i),readonly:"",id:"referral_link",placeholder:"Referral Link"},null,8,Le),t("button",{class:"text-copy-btn",type:"button",onClick:z(p,["prevent"]),id:"referred_by"},l[2]||(l[2]=[t("i",{class:"far fa-copy"},null,-1)]))])):q("",!0),t("div",He,[l[4]||(l[4]=t("span",{class:"gradient-color",id:"referred_by"},"Referred By:",-1)),M(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[0]||(l[0]=O=>e(c).referral=O),onBlur:y,id:"referred_by",placeholder:"Enter Referred By Wallet"},null,544),[[W,e(c).referral]])]),l[5]||(l[5]=t("div",{class:"line-divider2 w-100 mb20 mt10"},null,-1))])):q("",!0)}},We=3*60*1e3,ge=de("stageData",{state:()=>({currentStage:{index:null,price:"",usdtPrice:"",target:null,tokensSold:null,percentageSold:null},isStageLoading:!1,lastUpdated:null}),getters:{isDataStale(){return this.lastUpdated?new Date().getTime()-this.lastUpdated>We:!0}},actions:{async fetchStageData(k=!1){if(!(!k&&!this.isDataStale))try{this.isStageLoading=!0;const{alchemyLink:r,SaleAddress:c,SaleContractABI:b}=me();if(!r)throw new Error("Alchemy link is not configured");const C=new _e(r);if(!c||!b)throw new Error("Contract address or ABI is missing");const i=await new te(c,b,C).currentStageInfo(),d=Number(se(i[0],0))+1,h=I(i[1]),p=I(i[2]),y=se(i[3],6),E=Number(I(i[6])).toFixed(4),l=parseFloat(h)>0?parseFloat(E)/parseFloat(h)*100:0;this.currentStage={index:d,price:p,usdtPrice:y,target:h,tokensSold:E,percentageSold:l.toFixed(1)},this.lastUpdated=new Date().getTime()}catch(r){throw r}finally{this.isStageLoading=!1}},async forceLoadStageData(){await this.fetchStageData(!0)}},persist:!0}),ze={class:"ecm-right-header"},Oe={class:"d-flex align-items-center justify-content-between flex-wrap"},je={class:"ico-progress"},Ye={key:1,class:"progress"},Je=["aria-valuenow"],Ke={__name:"IcoStat",setup(k){const r=ge(),{currentStage:c,isStageLoading:b}=K(r);return(C,S)=>{const i=Ve;return a(),o("div",ze,[t("ul",Oe,[e(b)?(a(),o(B,{key:0},[t("li",null,[u(e(g),{width:"215",height:"30",pill:""})]),t("li",null,[u(e(g),{width:"180",height:"30",pill:""})])],64)):(a(),o(B,{key:1},[t("li",null,"Stage "+w(e(c).index)+": "+w(e(c).tokensSold)+" ECM",1),t("li",null,"Max: "+w(e(c).target)+" ECM",1)],64))]),t("div",je,[e(b)?(a(),U(e(g),{key:0,height:"30",pill:""})):(a(),o("div",Ye,[t("div",{class:"progress-bar align-items-end",role:"progressbar",style:we({width:e(c).percentageSold+"%"}),"aria-valuenow":e(c).percentageSold,"aria-valuemin":"0","aria-valuemax":"100"},[t("span",null,w(e(c).percentageSold)+"%",1)],12,Je)]))]),S[0]||(S[0]=t("div",{class:"line-divider2 w-100 mt-20 mb20"},null,-1)),e(b)?(a(),o(B,{key:0},[u(e(g),{width:"100%",height:"52"}),u(e(g),{width:"100%",height:"52",class:"mt-2"})],64)):(a(),U(i,{key:1}))])}}},qe={},Qe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 512 512"};function Xe(k,r){return a(),o("svg",Qe,r[0]||(r[0]=[t("path",{fill:"currentColor",fillRule:"evenodd",d:"m109.72 221.26l37.711 37.712l25.065-25.064l30.17 30.17l-25.065 25.064l45.255 45.255l25.065-25.064l30.17 30.17l-25.065 25.064l37.713 37.712l-30.17 30.17l-15.085-15.085c-36.49 36.49-92.839 41.015-134.255 13.577l-36.25 36.247l-30.169-30.17l36.248-36.249c-27.438-41.416-22.913-97.765 13.577-134.255L79.55 251.43zM89.75 59.58l362.668 362.668l-30.17 30.17L59.58 89.75zm35.055 237.104c-24.994 24.994-24.994 65.516 0 90.51c24.1 24.1 62.641 24.962 87.773 2.582l2.736-2.582zM437.019 44.81l30.17 30.17l-46.915 46.916c27.438 41.416 22.913 97.765-13.577 134.255l15.085 15.085l-30.17 30.17l-181.02-181.02l30.17-30.17l15.086 15.085c36.49-36.49 92.839-41.015 134.254-13.576zm-148.266 88.079l-2.735 2.582l89.377 89.377c17.735-26.918 22.652-67.857 1.132-89.377c-24.1-24.1-62.641-24.961-87.774-2.582"},null,-1)]))}const Ze=xe(qe,[["render",Xe]]),Ge={class:"row align-items-center"},et={class:"col-xl-6"},tt={class:"col-xl-6"},st={class:"ecm-right-box"},at={class:"ecm-form mt15"},nt={key:0,class:"mb20"},ot={key:1,class:"mb20"},lt={class:"ico-tab mb20"},rt={key:0,class:"d-flex align-items-center g-20"},it={key:1,class:"d-flex align-items-center g-20"},ct={class:"ico-tab-content"},dt={key:1,class:"d-flex justify-content-center mt-1 mb20"},ut={class:"text-white"},pt={class:"subscribe-form"},mt={class:"subscribe-email mb20 d-flex align-items-center mw-100"},ft=["readonly"],gt={class:"subscribe-email mb20 d-flex align-items-center mw-100"},ht=["readonly"],vt=["disabled"],bt={class:"fa fa-spinner fa-spin me-1"},yt={class:"ico-tab-content"},_t={key:1,class:"d-flex justify-content-center mt-1 mb20"},wt={class:"text-white"},xt={class:"subscribe-form"},St={class:"subscribe-email mb20 d-flex align-items-center mw-100"},kt=["readonly"],Ct={class:"subscribe-email mb20 d-flex align-items-center mw-100"},Et=["readonly"],$t=["disabled"],Dt={class:"fa fa-spinner fa-spin me-1"},Tt=["href"],At={class:"clip-text"},Mt=["disabled"],Ht={__name:"Index",setup(k){const r=pe(),c=ae(),{modal:b,disconnect:C,SaleAddress:S,SaleContractABI:i,USDTAddress:d,IERC20ABI:h}=me(),p=P(!1),y=P("Buy ECM"),{toastSuccess:E,toastError:l}=Te(),O=ge(),{currentStage:x,isStageLoading:$}=K(O),he=fe(),{referral:ne}=K(he);Se(async()=>{await oe()});const oe=async(f=!1)=>{try{await O.fetchStageData(f)}catch{l("Failed to load stage data. Please try again.")}},_=P(""),D=P(""),T=P(""),N=P("");ue([_,D,T],([f,s,v],[H,A,R])=>{if(s!==A&&!isNaN(s)){const n=parseFloat((s/x.value.price).toFixed(6));_.value=n.toString(),T.value=parseFloat((n*x.value.usdtPrice).toFixed(2)).toString()}else if(v!==R&&!isNaN(v)){const n=parseFloat((v/x.value.usdtPrice).toFixed(6));_.value=n.toString(),D.value=parseFloat((n*x.value.price).toFixed(6)).toString()}else f!==H&&!isNaN(f)&&(D.value=parseFloat((f*x.value.price).toFixed(6)).toString(),T.value=parseFloat((f*x.value.usdtPrice).toFixed(2)).toString())});const L=P("eth-coin-form"),le=f=>{L.value=f},Q=(f,s="eth")=>{const v=Number(f);return isNaN(v)||v<=0?!1:s==="ecm"?v<=x.value.target:!0},re=async f=>{if(!p.value)try{N.value=null,p.value=!0,y.value="Wallet connecting...";const s=parseFloat(x.value.target)-parseFloat(x.value.tokensSold),v=parseFloat(_.value);if(!Q(D.value)||!Q(_.value,"ecm")||!Q(T.value,"usdt"))throw new Error("Enter valid ECM or ETH amount.");if(v>s)throw new Error(`Purchase amount (${v.toFixed(2)} ECM) exceeds maximum purchasable amount (${s.toFixed(2)} ECM)`);const{walletProvider:H}=ke("eip155"),R=await new Ce(H).getSigner();let n;if(f==="USDT"){const j=new te(d,h,R);y.value="Approving USDT...";const m=await j.balanceOf(r.value.address);if(n=ce(T.value,6),BigInt(m)<BigInt(n))throw new Error(`Insufficient USDT balance. You have ${se(m,6)} USDT`);await(await j.approve(S,n)).wait()}const X=new te(S,i,R);y.value="Transaction Processing...";let Z;f==="ETH"?Z=await X.buyECMWithETH(ne.value,{value:ce(D.value,18)}):f==="USDT"&&(Z=await X.buyECMWithUSDT(n,ne.value));const G=await Z.wait();N.value=G.hash,await ve();let F={hash:G.hash,buyer:"",amount:"",stage:"",referralAddress:null,referralAmount:null,referralETH:null,paymentType:null};G.logs.forEach(j=>{try{const m=X.interface.parseLog(j);(m==null?void 0:m.name)==="ECMPurchased"?(F.buyer=m.args[0],F.amount=I(m.args[1]),F.stage=m.args[2].toString(),F.paymentType=m.args[3].toString()):(m==null?void 0:m.name)==="ReferralRewardPaid"&&(F.referralAddress=m.args[0],F.referralAmount=I(m.args[1]),F.referralETH=I(m.args[2]))}catch{}}),await $fetch(`${c.public.apiBase}/purchase-ecm-completed`,{method:"POST",body:JSON.stringify(F)}),E("ECM purchase successfully completed.")}catch(s){const v=s.shortMessage?s.shortMessage.charAt(0).toUpperCase()+s.shortMessage.slice(1):s.message||"Unknown error occurred";l(v)}finally{p.value=!1,y.value="Buy ECM",_.value="",D.value="",T.value=""}},ve=async()=>{await oe(!0)};return(f,s)=>{const v=Ue,H=Ke,A=De,R=Ze;return a(),o("div",Ge,[t("div",et,[u(v)]),t("div",tt,[t("div",st,[u(H),t("div",at,[e($)?(a(),o("h4",nt,[u(e(g),{height:"36",pill:"",class:"mt-2"})])):(a(),o("h4",ot,"ICO is Live")),t("div",lt,[e($)?(a(),o("div",rt,[u(e(g),{width:"50%",as:"div",height:"54",pill:""}),u(e(g),{width:"50%",as:"div",height:"54",pill:""})])):(a(),o("ul",it,[t("li",{class:ee(["ico-tab-btn gradient-btn w-50",{active:e(L)==="eth-coin-form"}]),onClick:s[0]||(s[0]=n=>le("eth-coin-form"))},[u(A,{src:"/images/icon/eth.png",loading:"lazy",alt:"eth"}),s[11]||(s[11]=V(" Buy with ETH ")),s[12]||(s[12]=t("span",{class:"ico-tab-select-icon"},[t("i",{class:"fa-solid fa-circle-check"})],-1))],2),t("li",{class:ee(["ico-tab-btn gradient-btn w-50",{active:e(L)==="usdt-coin-form"}]),onClick:s[1]||(s[1]=n=>le("usdt-coin-form"))},[u(A,{src:"/images/icon/usdt.png",alt:"ecm"}),s[13]||(s[13]=V(" Buy with USDT ")),s[14]||(s[14]=t("span",{class:"ico-tab-select-icon"},[t("i",{class:"fa-solid fa-circle-check"})],-1))],2)]))]),M(t("div",ct,[e($)?(a(),U(e(g),{key:0,height:"30",pill:"",class:"mb-4"})):(a(),o("ul",dt,[t("li",ut,"1 ECM = "+w(e(x).price)+" ETH",1)])),t("div",pt,[e($)?(a(),o(B,{key:0},ie(3,n=>u(e(g),{key:n,class:"mt-2",height:"55"})),64)):(a(),o("form",{key:1,onSubmit:s[5]||(s[5]=z(n=>re("ETH"),["prevent"]))},[t("div",mt,[u(A,{src:"/images/icon/ecm.png",alt:"icon"}),M(t("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>J(_)?_.value=n:null),type:"text",placeholder:"ECM Amount",readonly:e(p)},null,8,ft),[[W,e(_)]])]),t("div",gt,[u(A,{src:"/images/icon/eth.png",alt:"icon"}),M(t("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>J(D)?D.value=n:null),type:"text",placeholder:"ETH Payable",readonly:e(p)},null,8,ht),[[W,e(D)]])]),e(r).isConnected?(a(),o("button",{key:0,type:"submit",disabled:e(p),class:"btn1 primary-btn submit-btn w-100 mb20"},[M(t("i",bt,null,512),[[Y,e(p)]]),V(" "+w(e(y)),1)],8,vt)):(a(),o("button",{key:1,type:"button",onClick:s[4]||(s[4]=n=>e(b).open()),class:"btn1 primary-btn submit-btn w-100 mb20"},w(e(y)),1))],32))])],512),[[Y,e(L)==="eth-coin-form"]]),M(t("div",yt,[e($)?(a(),U(e(g),{key:0,height:"30",pill:"",class:"mb-4"})):(a(),o("ul",_t,[t("li",wt,"1 ECM = "+w(e(x).usdtPrice)+" USDT",1)])),t("div",xt,[e($)?(a(),o(B,{key:0},ie(3,n=>u(e(g),{key:n,class:"mt-2",height:"55"})),64)):(a(),o("form",{key:1,onSubmit:s[9]||(s[9]=z(n=>re("USDT"),["prevent"]))},[t("div",St,[u(A,{src:"/images/icon/ecm.png",alt:"icon"}),M(t("input",{"onUpdate:modelValue":s[6]||(s[6]=n=>J(_)?_.value=n:null),type:"text",placeholder:"ECM Amount",readonly:e(p)},null,8,kt),[[W,e(_)]])]),t("div",Ct,[u(A,{src:"/images/icon/usdt.png",alt:"icon"}),M(t("input",{"onUpdate:modelValue":s[7]||(s[7]=n=>J(T)?T.value=n:null),type:"text",placeholder:"USDT Payable",readonly:e(p)},null,8,Et),[[W,e(T)]])]),e(r).isConnected?(a(),o("button",{key:0,type:"submit",disabled:e(p),class:"btn1 primary-btn submit-btn w-100 mb20"},[M(t("i",Dt,null,512),[[Y,e(p)]]),V(" "+w(e(y)),1)],8,$t)):(a(),o("button",{key:1,type:"button",onClick:s[8]||(s[8]=n=>e(b).open()),class:"btn1 primary-btn submit-btn w-100 mb20"},w(e(y)),1))],32))])],512),[[Y,e(L)==="usdt-coin-form"]])]),e($)?(a(),U(e(g),{key:0,height:"55"})):(a(),o(B,{key:1},[e(N)?(a(),o("a",{key:0,href:`https://etherscan.io/tx/${e(N)}`,target:"_blank",class:"green-outline-btn d-flex align-items-center justify-content-between mt-20"},[s[15]||(s[15]=t("span",{class:"gradient-color"},[t("b",null,"Hash:")],-1)),t("span",At,w(e(N)),1),s[16]||(s[16]=t("span",{class:"text-copy-btn rotate-50"},[t("i",{class:"fa-solid fa-arrow-right-long"})],-1))],8,Tt)):q("",!0)],64)),t("div",{class:ee(["mt-3",{"text-center":!e($)}])},[e($)?(a(),U(e(g),{key:0,height:"55"})):e(r).isConnected?(a(),o("button",{key:1,type:"button",class:"red-outline-btn w-100 d-flex justify-content-center align-items-center mt-20",disabled:e(p),onClick:s[10]||(s[10]=z((...n)=>e(C)&&e(C)(...n),["prevent"]))},[s[17]||(s[17]=V(" Disconnect ")),u(R)],8,Mt)):q("",!0)],2)])])])}}};export{Ht as _};
