{"file":"login-D5-_yHM4.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEC,UAAM,EAAE,YAAa,IAAG,aAAc;AAEtC,UAAM,SAAS,iBAAkB;AACH,YAAO;AACrC,UAAM,kBAAkB,IAAI,KAAK;AACjC,UAAM,aAAa,IAAI,gBAAgB;AAIvC,UAAM,OAAO,SAAS;AAAA,MACrB,UAAU;AAAA,MACV,UAAU;AAAA,IACZ,CAAE;AAuBsB,WAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":[],"sources":["../../../../pages/auth/login.vue"],"sourcesContent":["<template>\n\t<div class=\"coin-details-hero-bg position-relative coin-details-hero-border custom-container\">\n\t\t<div class=\"login-form ptb80\">\n\t\t\t<div class=\"modal-custom-width page-modal-width\">\n\t\t\t\t<div class=\"modal-content custom-modal\">\n\t\t\t\t\t<form @submit.prevent=\"handelForm\">\n\t\t\t\t\t\t<div class=\"modal-header-area d-flex align-items-center justify-content-between\">\n\t\t\t\t\t\t\t<h4 class=\"text-shadow\">Log In</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"modal-body-inner\">\n\t\t\t\t\t\t\t<div class=\"row gy-3\">\n\t\t\t\t\t\t\t\t<div class=\"form-group col-md-12\">\n\t\t\t\t\t\t\t\t\t<label for=\"username\">Email or Username</label>\n\t\t\t\t\t\t\t\t\t<div class=\"input bg-border-input\">\n\t\t\t\t\t\t\t\t\t\t<input v-model=\"form.username\" type=\"text\" class=\"form-control\" :class=\"{ 'is-invalid': form.errors.has('username') }\" id=\"username\" placeholder=\"Enter email or username or Unique ID\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<FormGroupHasError :form=\"form\" field=\"username\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"form-group col-md-12\">\n\t\t\t\t\t\t\t\t\t<label for=\"password\">Password</label>\n\t\t\t\t\t\t\t\t\t<div class=\"input bg-border-input\">\n\t\t\t\t\t\t\t\t\t\t<input v-model=\"form.password\" type=\"password\" :class=\"{ 'is-invalid': form.errors.has('password') }\" class=\"form-control\" id=\"password\" placeholder=\"Enter valid password\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<FormGroupHasError :form=\"form\" field=\"password\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"form-group col-md-12 d-flex align-items-center justify-content-between flex-wrap\">\n\t\t\t\t\t\t\t\t\t<nuxt-link to=\"/auth/forgot-password\" class=\"gradient-color\">Forgot Password?</nuxt-link>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"form-group col-md-12\">\n\t\t\t\t\t\t\t\t\t<button type=\"submit\" :disabled=\"form.busy\" class=\"btn1 primary-btn subscribe-btn w-100\">\n\t\t\t\t\t\t\t\t\t\t<template v-if=\"form.busy\">\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-spinner fa-spin me-1\"></i>\n\t\t\t\t\t\t\t\t\t\t\tProcessing for\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\tLogin Now\n\t\t\t\t\t\t\t\t\t\t<span class=\"icon-rotate\"><i class=\"fas fa-arrow-right\"></i></span>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"d-flex justify-content-center mt-20 mb20\">\n\t\t\t\t\t\t\t\t\t<p class=\"modal-or-divider or-divider w-80\">OR</p>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"form-group col-md-12 m-0\">\n\t\t\t\t\t\t\t\t\t<button type=\"button\" :disabled=\"isLoadingWallet\" @click=\"handelWeb3Login\" class=\"btn1 primary-btn subscribe-btn w-100\">\n\t\t\t\t\t\t\t\t\t\t<template v-if=\"isLoadingWallet\">\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-spinner fa-spin me-1\"></i>\n\t\t\t\t\t\t\t\t\t\t\tProcessing for\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t{{ walletText }}\n\t\t\t\t\t\t\t\t\t\t<span :class=\"{ 'icon-rotate': wallet.isConnected }\"><i class=\"fa-solid\" :class=\"wallet.isConnected ? 'fa-arrow-right' : 'fa-wallet'\"></i></span>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div v-if=\"wallet.isConnected\" class=\"form-group col-md-12\">\n\t\t\t\t\t\t\t\t\t<button type=\"button\" @click=\"disconnect\" class=\"btn1 primary-btn subscribe-btn w-100\">\n\t\t\t\t\t\t\t\t\t\tDisconnect Wallet\n\t\t\t\t\t\t\t\t\t\t<span class=\"icon-rotate\"><i class=\"fas fa-unlink\"></i></span>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script setup>\n\timport { useAppKitAccount, useAppKitProvider } from \"@reown/appkit/vue\";\n\timport { BrowserProvider } from 'ethers';\n\n\tconst { loginAction } = useAuthStore();\n\tconst { toastSuccess } = useToastAlert();\n\tconst wallet = useAppKitAccount();\n\tconst { modal, disconnect } = useWeb3();\n\tconst isLoadingWallet = ref(false);\n\tconst walletText = ref('Connect Wallet');\n\tconst { toastError } = useToastAlert();\n\tconst { getCsrfToken } = useCsrf();\n\n\tconst form = useVForm({\n\t\tusername: '',\n\t\tpassword: '',\n\t});\n\n\tconst handelForm = async () => {\n\t\tawait getCsrfToken();\n\t\tawait form.submit('/auth/login').then(async (data) => {\n\t\t\tawait loginAction(data);\n\t\t\ttoastSuccess(\"Login successfully Completed.\");\n\t\t\tnavigateTo('/dashboard');\n\t\t}).catch((error) => { });\n\t}\n\n\tconst generateSignatureMessage = (address) => {\n\t\treturn [\n\t\t\t\"Welcome to MyCoinPoll!\",\n\t\t\t\"\",\n\t\t\t\"Signing confirms wallet ownership and agreement to our terms. No transaction or fees involvedâ€”authentication only.\",\n\t\t\t\"\",\n\t\t\t`Wallet: ${address}`,\n\t\t\t\"\",\n\t\t\t\"Thank you for being a part of our community!\"\n\t\t].join(\"\\n\");\n\t};\n\n\tconst { useMyFetch } = useApi();\n\tconst config = useRuntimeConfig();\n\tconst handelWeb3Login = async () => {\n\t\tisLoadingWallet.value = true;\n\t\tif (!wallet.value.isConnected) {\n\t\t\tmodal.open();\n\t\t\tisLoadingWallet.value = false;\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tconst { walletProvider } = useAppKitProvider('eip155');\n\t\t\tconst ethersProvider = new BrowserProvider(walletProvider);\n\t\t\tconst signer = await ethersProvider.getSigner();\n\t\t\tif (!signer) {\n\t\t\t\tthrow new Error('No signer available');\n\t\t\t}\n\t\t\tconst message = generateSignatureMessage(signer.address);\n\t\t\tconst signature = await signer.signMessage(message);\n\t\t\tawait getCsrfToken();\n\t\t\tconst { data } = await useMyFetch('/auth/web3-login', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tserver: false,\n\t\t\t\tbody: {\n\t\t\t\t\tmessage,\n\t\t\t\t\taddress: signer.address,\n\t\t\t\t\tsignature,\n\t\t\t\t},\n\t\t\t});\n\t\t\tawait loginAction(data.value);\n\t\t\ttoastSuccess(\"Login successfully completed\");\n\t\t\tawait navigateTo('/dashboard');\n\t\t} catch (error) {\n\t\t\tconst errorMessage = {\n\t\t\t\t'No signer available': 'Please check your wallet connection.',\n\t\t\t\t'User rejected request': 'You declined the signature request.',\n\t\t\t}[error.message] || \"An unexpected error occurred. Please try again.\";\n\t\t\ttoastError(errorMessage);\n\t\t} finally {\n\t\t\tisLoadingWallet.value = false;\n\t\t}\n\t}\n\n</script>\n\n<style>\n</style>\t"],"version":3}