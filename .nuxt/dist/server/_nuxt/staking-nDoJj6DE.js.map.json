{"file":"staking-nDoJj6DE.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2NgB,qBAAgB;AACb,YAAO;AAQzB,UAAM,MAAM,IAAI,CAAC;AACjB,UAAM,SAAS,IAAI,CAAC;AACpB,UAAM,WAAW,IAAI,CAAC;AACtB,UAAM,aAAa,IAAI,CAAC;AACN,QAAI,CAAC;AACvB,UAAM,kBAAkB,IAAI,CAAC;AAC7B,UAAM,iBAAiB,IAAI,CAAC;AAC5B,UAAM,UAAU,IAAI,IAAI;AAExB,UAAM,EAAE,aAAc,IAAG,OAAQ;AACjC,UAAM,EAAE,MAAM,MAAO,KAAG,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAM,aAAa,oBAAoB,CAAA;AAE/D,UAAM,EAAE,MAAM,SAAS,SAAS,QAAS,KAAG,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAM,aAAa,sBAAsB,CAAA;AA0CrF,UAAM,aAAa,MAAM;AACxB,UAAI,CAAC,SAAS,MAAO,QAAO;AAC5B,YAAM,OAAO,oBAAI,KAAM;AACvB,WAAK,QAAQ,KAAK,QAAO,IAAK,SAAS,KAAK;AAC5C,YAAM,MAAM,KAAK,QAAS;AAC1B,YAAM,QAAQ,KAAK,eAAe,SAAS,EAAE,OAAO,QAAQ;AAC5D,YAAM,OAAO,KAAK,YAAa;AAC/B,YAAM,QAAQ,KAAK,SAAU,IAAG,MAAM;AACtC,YAAM,UAAU,KAAK,WAAY,EAAC,SAAQ,EAAG,SAAS,GAAG,GAAG;AAC5D,YAAM,OAAO,KAAK,SAAU,KAAI,KAAK,OAAO;AAC5C,YAAM,SAAS,CAAC,MAAM,MAAM,MAAM,IAAI,EAAE,MAAM,KAAK,IAAI,KAAK,MAAM,MAAM,MAAM,MAAM,OAAO,MAAM,GAAG;AACpG,aAAO,GAAG,GAAG,GAAG,MAAM,KAAK,KAAK,IAAI,IAAI,IAAI,KAAK,IAAI,OAAO,IAAI,IAAI;AAAA,IACpE;AAED,UAAM,CAAC,QAAQ,YAAY,QAAQ,GAAG,MAAM;AAC3C,UAAI,OAAO,QAAQ,KAAK,SAAS,QAAQ,KAAK,WAAW,QAAQ,GAAG;AACnE,cAAM,cAAc,WAAW,OAAO,KAAK,IAAI,WAAW,QAAQ;AAClE,wBAAgB,QAAQ,OAAO,YAAY,QAAQ,CAAC,CAAC;AACrD,uBAAe,QAAQ,QAAQ,WAAW,OAAO,KAAK,IAAI,aAAa,QAAQ,CAAC,CAAC;AAAA,MACpF,OAAS;AACN,wBAAgB,QAAQ;AACxB,uBAAe,QAAQ;AAAA,MAC1B;AAAA,IACA,GAAI,EAAE,WAAW,MAAM;AAEtB,UAAM,UAAU,IAAI,WAAW;AAC/B,UAAM,YAAY,IAAI,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":["_withAsyncContext"],"sources":["../../../../pages/dashboard/staking.vue"],"sourcesContent":["<template>\n\t<div class=\"dashboard-body mt30\">\n\t\t<div class=\"staking-section\">\n\t\t\t<div class=\"row\">\n\t\t\t\t<div class=\"col-md-12\">\n\t\t\t\t\t<form action=\"\">\n\t\t\t\t\t\t<div class=\"d-flex h-100 justify-content-between g-20 flex-xl-nowrap flex-wrap\">\n\t\t\t\t\t\t\t<div class=\"staking-header-item\">\n\t\t\t\t\t\t\t\t<div class=\"taking-value-area d-flex align-items-center g-10 justify-content-between\">\n\t\t\t\t\t\t\t\t\t<div class=\"staking-value d-flex align-items-center g-10\">\n\t\t\t\t\t\t\t\t\t\t<nuxt-img src=\"/images/icon/ecm.png\" loading=\"lazy\" placeholder placeholder-class=\"rounded-circle\" alt=\"ecm-logo\" />\n\t\t\t\t\t\t\t\t\t\t<input type=\"text\" v-model=\"amount\" placeholder=\"Enter ECM amount\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"balance\">\n\t\t\t\t\t\t\t\t\t\t<p>Balance</p>\n\t\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t\t<span>{{ ecm }}</span>\n\t\t\t\t\t\t\t\t\t\t\tECM\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"d-flex align-items-center mt-3 g-20 flex-wrap\">\n\t\t\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"staking-days-select-btn bg-border-input\">\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"one\" class=\"public-radio\" @change=\"handlePercentageSelect\" name=\"stakingPercentage\" value=\"1\" />\n\t\t\t\t\t\t\t\t\t\t\t<label for=\"one\">\n\t\t\t\t\t\t\t\t\t\t\t\t25%\n\t\t\t\t\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"bg-border-input staking-days-select-btn\">\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"two\" class=\"public-radio\" @change=\"handlePercentageSelect\" name=\"stakingPercentage\" value=\"2\" />\n\t\t\t\t\t\t\t\t\t\t\t<label for=\"two\">\n\t\t\t\t\t\t\t\t\t\t\t\t50%\n\t\t\t\t\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"bg-border-input staking-days-select-btn\">\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"three\" class=\"public-radio\" @change=\"handlePercentageSelect\" name=\"stakingPercentage\" value=\"3\" />\n\t\t\t\t\t\t\t\t\t\t\t<label for=\"three\">\n\t\t\t\t\t\t\t\t\t\t\t\t75%\n\t\t\t\t\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"bg-border-input staking-days-select-btn\">\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"four\" class=\"public-radio\" @change=\"handlePercentageSelect\" name=\"stakingPercentage\" value=\"4\" />\n\t\t\t\t\t\t\t\t\t\t\t<label for=\"four\">\n\t\t\t\t\t\t\t\t\t\t\t\tMax\n\t\t\t\t\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"staking-header-item\">\n\t\t\t\t\t\t\t\t<div class=\"taking-value-area d-flex align-items-center g-10 justify-content-between\">\n\t\t\t\t\t\t\t\t\t<div class=\"staking-value d-flex align-items-center g-10\">\n\t\t\t\t\t\t\t\t\t\t<nuxt-img src=\"/images/icon/timer.png\" loading=\"lazy\" placeholder placeholder-class=\"rounded-circle\" alt=\"timer\" />\n\t\t\t\t\t\t\t\t\t\t<p>{{ duration }}</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"days-value\">\n\t\t\t\t\t\t\t\t\t\t<p>Days</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"d-flex align-items-center mt-3 g-20 flex-wrap\">\n\t\t\t\t\t\t\t\t\t<div v-for=\"(plan, i) in plans\" :key=\"i\" class=\"form-group\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"bg-border-input staking-days-select-btn\">\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" :id=\"`stakingweek_${i + 1}`\" :value=\"plan.duration\" @change=\"handleDurationSelection(plan)\" class=\"public-radio\" name=\"stakingweek\" />\n\t\t\t\t\t\t\t\t\t\t\t<label :for=\"`stakingweek_${i + 1}`\">\n\t\t\t\t\t\t\t\t\t\t\t\t{{ plan.name }}\n\t\t\t\t\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"mt-4\">\n\t\t\t\t\t\t\t<span class=\"label\">Lock Overview</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"lock-overview d-flex align-items-center justify-content-center mt-2\">\n\t\t\t\t\t\t\t<div class=\"selected-staking-title d-flex align-items-center g-10\">\n\t\t\t\t\t\t\t\t<nuxt-img src=\"/images/icon/ecm.png\" width=\"30\" loading=\"lazy\" placeholder placeholder-class=\"rounded-circle\" alt=\"icon\" />\n\t\t\t\t\t\t\t\t<h6 class=\"page-title\">My {{ amount }} ECM Stack for {{ duration }} Days</h6>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"d-flex align-items-center justify-content-between flex-wrap flex-md-nowrap g-10 mt-4\">\n\t\t\t\t\t\t\t<div class=\"milestone-offer-card w-100\">\n\t\t\t\t\t\t\t\t<div class=\"milestone-offer-info-item d-flex align-items-center justify-content-between\">\n\t\t\t\t\t\t\t\t\t<p>Stack amount</p>\n\t\t\t\t\t\t\t\t\t<span>{{ amount }} ECM</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<!-- item -->\n\t\t\t\t\t\t\t\t<div class=\"milestone-offer-info-item d-flex align-items-center justify-content-between\">\n\t\t\t\t\t\t\t\t\t<p>Estimated Profit</p>\n\t\t\t\t\t\t\t\t\t<span class=\"text-color-1CD691\">{{ estimate_profit }} ECM</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<!-- item -->\n\t\t\t\t\t\t\t\t<div class=\"milestone-offer-info-item d-flex align-items-center justify-content-between\">\n\t\t\t\t\t\t\t\t\t<p>Total with Reward</p>\n\t\t\t\t\t\t\t\t\t<span>{{ estimate_total }} ECM</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"milestone-offer-card w-100\">\n\t\t\t\t\t\t\t\t<!-- item -->\n\t\t\t\t\t\t\t\t<div class=\"milestone-offer-info-item d-flex align-items-center justify-content-between\">\n\t\t\t\t\t\t\t\t\t<p>ECM to be locked</p>\n\t\t\t\t\t\t\t\t\t<span>{{ amount }} ECM</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<!-- item -->\n\t\t\t\t\t\t\t\t<div class=\"milestone-offer-info-item d-flex align-items-center justify-content-between\">\n\t\t\t\t\t\t\t\t\t<p>Duration</p>\n\t\t\t\t\t\t\t\t\t<span class=\"text-color-1CD691\">{{ duration }} days</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<!-- item -->\n\t\t\t\t\t\t\t\t<div class=\"milestone-offer-info-item d-flex align-items-center justify-content-between\">\n\t\t\t\t\t\t\t\t\t<p>Unlocked on</p>\n\t\t\t\t\t\t\t\t\t<span>{{ unlockDate() }}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"d-flex align-items-center justify-content-md-between justify-content-center flex-wrap flex-md-nowrap g-10 mt-4\">\n\t\t\t\t\t\t\t<button type=\"button\" :disabled=\"isLoading\" @click.prevent=\"handleStakeNow\" class=\"gradient-btn w-50\">\n\t\t\t\t\t\t\t\t<i v-show=\"isLoading\" class=\"fa fa-spinner fa-spin me-1\"></i>\n\t\t\t\t\t\t\t\t{{ btnText }}\n\t\t\t\t\t\t\t\t<span v-show=\"!isLoading\" class=\"icon-rotate\"><i class=\"fas fa-arrow-right\"></i></span>\n\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t<nuxt-link :to=\"{ name: 'dashboard-ico' }\" class=\"transparent-btn border-gradient w-50\">\n\t\t\t\t\t\t\t\tBuy ECM\n\t\t\t\t\t\t\t\t<i class=\"fa-solid fa-cart-shopping\"></i>\n\t\t\t\t\t\t\t</nuxt-link>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"w-100 mt-4\" v-if=\"trxHash\">\n\t\t\t\t\t\t\t<a :href=\"`https://etherscan.io/tx/${trxHash}`\" target=\"_blank\" class=\"transparent-btn border-gradient d-flex align-items-center justify-content-center g-10\">\n\t\t\t\t\t\t\t\t<span><b>Hash :</b></span>\n\t\t\t\t\t\t\t\t<span class=\"clip-text w-auto\">{{ trxHash }}</span>\n\t\t\t\t\t\t\t\t<span class=\"text-copy-btn rotate-50\"><i class=\"fa-solid fa-arrow-right-long\"></i></span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"data-show-table-area dashboard-box mt30\">\n\t\t\t<div class=\"table-header-area d-flex align-items-center justify-content-between\">\n\t\t\t\t<div class=\"table-heading\">\n\t\t\t\t\t<h5>Staking History</h5>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"search-box-area\">\n\t\t\t\t\t<form action=\"\">\n\t\t\t\t\t\t<div class=\"input bg-border-input position-relative\">\n\t\t\t\t\t\t\t<div class=\"search-icon\">\n\t\t\t\t\t\t\t\t<i class=\"search-icon fas fa-search\"></i>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control\" id=\"search\" placeholder=\"Search here...\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<client-only>\n\t\t\t\t<div class=\"common-table mt30\" v-if=\"!pending\">\n\t\t\t\t\t<table class=\"custom-table display nowrap mobile-table\">\n\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th>SL</th>\n\t\t\t\t\t\t\t\t<th>Date</th>\n\t\t\t\t\t\t\t\t<th>Amount</th>\n\t\t\t\t\t\t\t\t<th>Percentage</th>\n\t\t\t\t\t\t\t\t<th>Duration</th>\n\t\t\t\t\t\t\t\t<th>Reward</th>\n\t\t\t\t\t\t\t\t<th>Total Receive</th>\n\t\t\t\t\t\t\t\t<th>Status</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t<tr v-for=\"(item, i) in history\" :key=\"i\">\n\t\t\t\t\t\t\t\t<td>{{ i + 1 }}</td>\n\t\t\t\t\t\t\t\t<td>{{ item.created_at_formatted }}</td>\n\t\t\t\t\t\t\t\t<td>{{ item.amount }} ECM</td>\n\t\t\t\t\t\t\t\t<td>{{ item.percentage }}%</td>\n\t\t\t\t\t\t\t\t<td>{{ item.duration }} day</td>\n\t\t\t\t\t\t\t\t<td>{{ item.reward }} ECM</td>\n\t\t\t\t\t\t\t\t<td>{{ item.total_receive }} ECM</td>\n\t\t\t\t\t\t\t\t<td class=\"text-start\">\n\t\t\t\t\t\t\t\t\t<template v-if=\"item.status === 'pending'\">\n\t\t\t\t\t\t\t\t\t\t<vue-countdown :time=\"item.remaining_time * 1000\" v-slot=\"{ days, hours, minutes, seconds }\">{{ days }}d:{{ hours }}h:{{ minutes }}m:{{ seconds }}s</vue-countdown>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else-if=\"item.status === 'completed'\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"completed-status badge\">Completed</span>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t\t<a href=\"#\" @click.prevent=\"unstake(item.id)\" class=\"gradient-btn-small bg-red\">Unstake Now</a>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</client-only>\n\t\t</div>\n\t</div>\n</template>\n\n<script  setup>\n\timport '@/assets/css/staking.css';\n\timport VueCountdown from '@chenfengyuan/vue-countdown';\n\timport { useAppKitAccount, useAppKitProvider } from '@reown/appkit/vue';\n\timport { BrowserProvider, Contract, formatEther, formatUnits, parseUnits } from 'ethers';\n\n\tconst wallet = useAppKitAccount();\n\tconst { modal } = useWeb3();\n\n\tdefinePageMeta({\n\t\ttitle: 'ECM Staking',\n\t\tlayout: 'backend',\n\t\tauthenticated: true\n\t});\n\n\tconst ecm = ref(0);\n\tconst amount = ref(0);\n\tconst duration = ref(0);\n\tconst percentage = ref(0);\n\tconst planIndex = ref(0);\n\tconst estimate_profit = ref(0);\n\tconst estimate_total = ref(0);\n\tconst trxHash = ref(null);\n\n\tconst { useOnlyFetch } = useApi();\n\tconst { data: plans } = await useOnlyFetch('/get-staking-plans');\n\n\tconst { data: history, pending, refresh } = await useOnlyFetch('/get-staking-history');\n\n\tconst handlePercentageSelect = (event) => {\n\t\tconst value = parseInt(event.target.value);\n\t\tconst balance = parseFloat(ecm.value);\n\t\tswitch (value) {\n\t\t\tcase 1: // 25%\n\t\t\t\tamount.value = (balance * 0.25).toFixed(4);\n\t\t\t\tbreak;\n\t\t\tcase 2: // 50%\n\t\t\t\tamount.value = (balance * 0.50).toFixed(4);\n\t\t\t\tbreak;\n\t\t\tcase 3: // 75%\n\t\t\t\tamount.value = (balance * 0.75).toFixed(4);\n\t\t\t\tbreak;\n\t\t\tcase 4: // Max (100%)\n\t\t\t\tamount.value = balance.toFixed(4);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tconst handleDurationSelection = (plan) => {\n\t\tduration.value = parseInt(plan.duration);\n\t\tpercentage.value = parseInt(plan.reward_percentage);\n\t\tplanIndex.value = parseInt(plan.id - 1);\n\t}\n\tconst loadUserEcm = async () => {\n\t\tif (wallet.value.isConnected) {\n\t\t\tconst { walletProvider } = useAppKitProvider('eip155');\n\t\t\tconst ethersProvider = new BrowserProvider(walletProvider)\n\t\t\tconst signer = await ethersProvider.getSigner();\n\t\t\tconst { ECMContractABI, TokenAddress } = useWeb3();\n\n\t\t\tconst ecmContract = new Contract(TokenAddress, ECMContractABI, signer);\n\t\t\tconst balance = await ecmContract.balanceOf(wallet.value.address);\n\t\t\tecm.value = Number(parseFloat(formatEther(balance)).toFixed(4));\n\t\t}\n\t\treturn 0;\n\t}\n\tonMounted(async () => {\n\t\tawait loadUserEcm();\n\t});\n\n\tconst unlockDate = () => {\n\t\tif (!duration.value) return '-';\n\t\tconst date = new Date();\n\t\tdate.setDate(date.getDate() + duration.value);\n\t\tconst day = date.getDate();\n\t\tconst month = date.toLocaleString('en-US', { month: 'long' });\n\t\tconst year = date.getFullYear();\n\t\tconst hours = date.getHours() % 12 || 12;\n\t\tconst minutes = date.getMinutes().toString().padStart(2, '0');\n\t\tconst ampm = date.getHours() >= 12 ? 'PM' : 'AM';\n\t\tconst suffix = ['th', 'st', 'nd', 'rd'][day % 10 > 3 ? 0 : (day % 100 - day % 10 != 10) * (day % 10)];\n\t\treturn `${day}${suffix}, ${month} ${year} ${hours}:${minutes} ${ampm}`;\n\t};\n\n\twatch([amount, percentage, duration], () => {\n\t\tif (amount.value > 0 && duration.value > 0 && percentage.value > 0) {\n\t\t\tconst profitValue = parseFloat(amount.value) * percentage.value / 100;\n\t\t\testimate_profit.value = Number(profitValue.toFixed(3));\n\t\t\testimate_total.value = Number((parseFloat(amount.value) + profitValue).toFixed(3));\n\t\t} else {\n\t\t\testimate_profit.value = 0;\n\t\t\testimate_total.value = 0;\n\t\t}\n\t}, { immediate: true });\n\n\tconst btnText = ref(\"Stake Now\");\n\tconst isLoading = ref(false);\n\tconst { toastError, toastSuccess } = useToastAlert();\n\tconst handleStakeNow = async () => {\n\t\tif (wallet.value.isConnected) {\n\t\t\tif (amount.value > 0 && duration.value > 0 && percentage.value > 0) {\n\t\t\t\ttry {\n\t\t\t\t\tisLoading.value = true;\n\t\t\t\t\tbtnText.value = \"Wallet Connecting...\";\n\t\t\t\t\tconst { walletProvider } = useAppKitProvider('eip155');\n\t\t\t\t\tconst ethersProvider = new BrowserProvider(walletProvider)\n\t\t\t\t\tconst signer = await ethersProvider.getSigner();\n\t\t\t\t\tconst { ECMStakingContractABI, StakingAddress, ECMContractABI, TokenAddress } = useWeb3();\n\n\t\t\t\t\tconst stakeAmount = parseUnits(amount.value, 18);\n\t\t\t\t\tconst ecmContract = new Contract(TokenAddress, ECMContractABI, signer);\n\n\t\t\t\t\tbtnText.value = \"Approving Stake Amount\";\n\t\t\t\t\tconst approveTx = await ecmContract.approve(StakingAddress, stakeAmount);\n\t\t\t\t\tawait approveTx.wait();\n\n\t\t\t\t\tbtnText.value = \"Staking on Processing...\";\n\t\t\t\t\tconst stakingContract = new Contract(StakingAddress, ECMStakingContractABI, signer);\n\t\t\t\t\tconst transaction = await stakingContract.stake(stakeAmount, planIndex.value);\n\n\t\t\t\t\tconst receipt = await transaction.wait();\n\t\t\t\t\ttrxHash.value = receipt.hash;\n\t\t\t\t\tbtnText.value = \"Staking Done!\";\n\t\t\t\t\tawait loadUserEcm();\n\t\t\t\t\treceipt.logs.forEach(async (log) => {\n\t\t\t\t\t\tconst parsedLog = stakingContract.interface.parseLog(log);\n\t\t\t\t\t\tif (parsedLog?.name === 'Staked') {\n\t\t\t\t\t\t\tconst payload = {\n\t\t\t\t\t\t\t\tstaker: parsedLog.args[0],\n\t\t\t\t\t\t\t\tstakeId: formatUnits(parsedLog.args[1], 0),\n\t\t\t\t\t\t\t\tamount: formatEther(parsedLog.args[2]),\n\t\t\t\t\t\t\t\tplanIndex: formatUnits(parsedLog.args[3], 0),\n\t\t\t\t\t\t\t\tendTime: formatUnits(parsedLog.args[4], 0),\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tawait useOnlyFetch('staking-created', {\n\t\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\t\tbody: payload\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\ttoastSuccess('Staking successfully Done!');\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconst errorMessage = error.shortMessage\n\t\t\t\t\t\t? error.shortMessage.charAt(0).toUpperCase() + error.shortMessage.slice(1)\n\t\t\t\t\t\t: error.message || 'Unknown error occurred';\n\t\t\t\t\ttoastError(errorMessage);\n\t\t\t\t} finally {\n\t\t\t\t\tisLoading.value = false;\n\t\t\t\t\tbtnText.value = \"Stake Now\";\n\t\t\t\t\tecm.value = 0;\n\t\t\t\t\tamount.value = 0;\n\t\t\t\t\tduration.value = 0;\n\t\t\t\t\tpercentage.value = 0;\n\t\t\t\t\tplanIndex.value = 0;\n\t\t\t\t\testimate_profit.value = 0;\n\t\t\t\t\testimate_total.value = 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttoastError('Please enter amount and select a plan');\n\t\t\t}\n\t\t} else {\n\t\t\tmodal.open();\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t:disabled {\n\t\tcursor: not-allowed;\n\t}\n</style>"],"version":3}