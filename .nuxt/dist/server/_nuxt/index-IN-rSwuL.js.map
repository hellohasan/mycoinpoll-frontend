{"version":3,"file":"index-IN-rSwuL.js","sources":["../../../../composables/useAuthAccess.ts","../../../../pages/dashboard/manage-blog/index.vue"],"sourcesContent":["/**\n * A composable that provides direct role and permission checks without using `.value`.\n */\nexport const useAuthAccess = () => {\n  const authStore = useAuthStore();\n\n  // Super admin role constant\n  const SUPER_ADMIN_ROLE = \"Super Admin\";\n\n  /**\n   * Check if the user is a super admin.\n   * @returns boolean\n   */\n  const isSuperAdmin = (): boolean => {\n    return authStore.roles.includes(SUPER_ADMIN_ROLE);\n  };\n\n  /**\n   * Check if the user has at least one of the required roles.\n   * @param roles - A role or list of roles.\n   * @returns boolean\n   */\n  const hasRole = (roles: string[] | string): boolean => {\n    // Super admin has all roles\n    if (isSuperAdmin()) return true;\n\n    const userRoles = authStore.roles as string[];\n\n    if (!Array.isArray(roles)) roles = [roles];\n    return roles.some((role) => userRoles.includes(role));\n  };\n\n  /**\n   * Check if the user has at least one of the required permissions.\n   * @param permissions - A permission or list of permissions.\n   * @returns boolean\n   */\n  const hasPermission = (permissions: string[] | string): boolean => {\n    // Super admin has all permissions\n    if (isSuperAdmin()) return true;\n\n    const userPermissions = authStore.permissions as string[];\n\n    if (!Array.isArray(permissions)) permissions = [permissions];\n    return permissions.some((permission) => userPermissions.includes(permission));\n  };\n\n  /**\n   * Check if the user has any of the given roles or permissions.\n   * @param roles - List of roles.\n   * @param permissions - List of permissions.\n   * @returns boolean\n   */\n  const hasAnyRoleOrPermission = (roles: string[] | string = [], permissions: string[] | string = []): boolean => {\n    // Super admin has all roles and permissions\n    if (isSuperAdmin()) return true;\n\n    return hasRole(roles) || hasPermission(permissions);\n  };\n\n  /**\n   * Check if the user has all the required roles.\n   * @param roles - A role or list of roles.\n   * @returns boolean\n   */\n  const hasAllRoles = (roles: string[] | string): boolean => {\n    // Super admin has all roles\n    if (isSuperAdmin()) return true;\n\n    if (!Array.isArray(roles)) roles = [roles];\n    return roles.every((role) => authStore.roles.includes(role));\n  };\n\n  /**\n   * Check if the user has all the required permissions.\n   * @param permissions - A permission or list of permissions.\n   * @returns boolean\n   */\n  const hasAllPermissions = (permissions: string[] | string): boolean => {\n    // Super admin has all permissions\n    if (isSuperAdmin()) return true;\n\n    if (!Array.isArray(permissions)) permissions = [permissions];\n    return permissions.every((permission) => authStore.permissions.includes(permission));\n  };\n\n  return {\n    hasRole,\n    hasPermission,\n    hasAnyRoleOrPermission,\n    hasAllRoles,\n    hasAllPermissions,\n    isSuperAdmin,\n  };\n};\n","<template>\n\t<div class=\"dashboard-body mt30\">\n\t\t<div class=\"dashboard-box mt30 custom-card-form\">\n\t\t\t<div class=\"custom-card-header d-flex align-items-center justify-content-between\">\n\t\t\t\t<div class=\"table-heading\">\n\t\t\t\t\t<h5>Blog List</h5>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"add-new-btn\">\n\t\t\t\t\t<nuxt-link :to=\"{ path: '/dashboard/manage-blog/create' }\" class=\"gradient-btn\">\n\t\t\t\t\t\t<i class=\"fas fa-plus\"></i>\n\t\t\t\t\t\tAdd New Blog\n\t\t\t\t\t</nuxt-link>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"card-line\"></div>\n\t\t\t<div class=\"row gy-4 mt-15\">\n\t\t\t\t<div class=\"col-xl-4 col-md-6\" v-for=\"blog in blogList\" :key=\"blog.id\">\n\t\t\t\t\t<div class=\"blog-post-card blog-post-card-color h-100\">\n\t\t\t\t\t\t<div class=\"blog-post-thumbnails position-relative\">\n\t\t\t\t\t\t\t<nuxt-img :src=\"blog.featured_image\" loading=\"lazy\" format=\"webp\" placeholder alt=\"img\" class=\"w-100\" />\n\t\t\t\t\t\t\t<div class=\"blog-status badge\" :class=\"blog.status == 1 ? 'active-status gradient-bg' : 'deactivated-status gradient-bg-red'\">\n\t\t\t\t\t\t\t\t{{ blog.status == 1 ? 'Published' : 'Unpublished' }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"blog-post-content mt-20\">\n\t\t\t\t\t\t\t<span class=\"publish-date d-flex align-items-center\">\n\t\t\t\t\t\t\t\t<i class=\"fa-solid fa-clock\"></i>\n\t\t\t\t\t\t\t\t{{ blog.publish_date }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<h4>{{ blog.title }}</h4>\n\t\t\t\t\t\t\t<p class=\"mt-3\">{{ blog.short_content }}.</p>\n\t\t\t\t\t\t\t<div class=\"line-1 mt-20\"></div>\n\t\t\t\t\t\t\t<div class=\"d-flex justify-content-between mt-15\">\n\t\t\t\t\t\t\t\t<span class=\"publish-date d-flex align-items-center\">\n\t\t\t\t\t\t\t\t\t<i class=\"fa-solid fa-eye\"></i>\n\t\t\t\t\t\t\t\t\t{{ blog.views_count }} Views\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"publish-date d-flex align-items-center\">\n\t\t\t\t\t\t\t\t\t<i class=\"fa-solid fa-comments\"></i>\n\t\t\t\t\t\t\t\t\t{{ blog.comments_count }} Comments\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<ul class=\"btn-group-card d-flex align-items-center justify-content-between mt-2\">\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<nuxt-link :to=\"{ path: `/blog-detail/${blog.slug}` }\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa-solid fa-eye green\"></i>\n\t\t\t\t\t\t\t\t\t\tView\n\t\t\t\t\t\t\t\t\t</nuxt-link>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li v-if=\"hasPermission('manage-blogs-edit')\">\n\t\t\t\t\t\t\t\t\t<nuxt-link :to=\"{ path: `/dashboard/manage-blog/edit`, query: { id: blog.id } }\">\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa-solid fa-pen skyblue\"></i>\n\t\t\t\t\t\t\t\t\t\tEdit\n\t\t\t\t\t\t\t\t\t</nuxt-link>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li v-if=\"hasPermission('manage-blogs-delete')\">\n\t\t\t\t\t\t\t\t\t<button type=\"button\" data-bs-toggle=\"modal\" @click.prevent=\"deleteBlog(blog.id)\">\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa-solid fa-trash-can red\"></i>\n\t\t\t\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script setup>\n\tdefinePageMeta({\n\t\ttitle: 'Blog List',\n\t\tlayout: 'backend',\n\t\tauthenticated: true,\n\t\tpermissions: ['manage-blog']\n\t});\n\tconst { hasPermission } = useAuthAccess();\n\tconst { useOnlyFetch } = useApi();\n\n\tconst blogList = ref([]);\n\tconst { refresh } = await useOnlyFetch('/manage-blogs', {\n\t\tmethod: 'get',\n\t\tasync onResponse({ response }) {\n\t\t\tblogList.value = response._data;\n\t\t}\n\t});\n\n\tconst { alert, confirm } = useSweetAlert();\n\tconst deleteBlog = async (id) => {\n\t\tconst isConfirmed = await confirm(\"Are you sure you want to delete this blog?\", \"warning\");\n\t\tif (isConfirmed) {\n\t\t\tawait useOnlyFetch(`/manage-blogs/${id}`, {\n\t\t\t\tmethod: 'DELETE',\n\t\t\t\tasync onResponse({ response }) {\n\t\t\t\t\tawait refresh();\n\t\t\t\t\talert(\"Blog deleted successfully.\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n</script>\n\n<style>\n</style>"],"names":["_withAsyncContext"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAGO,MAAM,gBAAgB,MAAM;AACjC,QAAM,YAAY,aAAa;AAG/B,QAAM,mBAAmB;AAMzB,QAAM,eAAe,MAAe;AAC3B,WAAA,UAAU,MAAM,SAAS,gBAAgB;AAAA,EAClD;AAOM,QAAA,UAAU,CAAC,UAAsC;AAEjD,QAAA,eAAuB,QAAA;AAE3B,UAAM,YAAY,UAAU;AAE5B,QAAI,CAAC,MAAM,QAAQ,KAAK,EAAG,SAAQ,CAAC,KAAK;AACzC,WAAO,MAAM,KAAK,CAAC,SAAS,UAAU,SAAS,IAAI,CAAC;AAAA,EACtD;AAOM,QAAA,gBAAgB,CAAC,gBAA4C;AAE7D,QAAA,eAAuB,QAAA;AAE3B,UAAM,kBAAkB,UAAU;AAElC,QAAI,CAAC,MAAM,QAAQ,WAAW,EAAG,eAAc,CAAC,WAAW;AAC3D,WAAO,YAAY,KAAK,CAAC,eAAe,gBAAgB,SAAS,UAAU,CAAC;AAAA,EAC9E;AAQA,QAAM,yBAAyB,CAAC,QAA2B,CAAA,GAAI,cAAiC,CAAA,MAAgB;AAE1G,QAAA,eAAuB,QAAA;AAE3B,WAAO,QAAQ,KAAK,KAAK,cAAc,WAAW;AAAA,EACpD;AAOM,QAAA,cAAc,CAAC,UAAsC;AAErD,QAAA,eAAuB,QAAA;AAE3B,QAAI,CAAC,MAAM,QAAQ,KAAK,EAAG,SAAQ,CAAC,KAAK;AAClC,WAAA,MAAM,MAAM,CAAC,SAAS,UAAU,MAAM,SAAS,IAAI,CAAC;AAAA,EAC7D;AAOM,QAAA,oBAAoB,CAAC,gBAA4C;AAEjE,QAAA,eAAuB,QAAA;AAE3B,QAAI,CAAC,MAAM,QAAQ,WAAW,EAAG,eAAc,CAAC,WAAW;AACpD,WAAA,YAAY,MAAM,CAAC,eAAe,UAAU,YAAY,SAAS,UAAU,CAAC;AAAA,EACrF;AAEO,SAAA;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;;;;;;ACjBC,UAAM,EAAE,cAAe,IAAG,cAAe;AACzC,UAAM,EAAE,aAAc,IAAG,OAAQ;AAEjC,UAAM,WAAW,IAAI,EAAE;AACvB,UAAM,EAAE,QAAS,KAAG,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAM,aAAa,iBAAiB;AAAA,MACvD,QAAQ;AAAA,MACR,MAAM,WAAW,EAAE,YAAY;AAC9B,iBAAS,QAAQ,SAAS;AAAA,MAC7B;AAAA,IACA,CAAE,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}